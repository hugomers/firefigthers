import{f as v,c as H,ar as Ce,as as Se,r as T,d as S,w as ae,o as se,a9 as oe,a8 as ie,V as Te,g as me,t as B,J as qe,k as E,m as Q,n as l,p as t,L as o,q as h,at as g,au as Pe,Q as q,av as ve,s as k,O as J}from"./index.aeaedf5f.js";import{h as Ee,i as Qe,j as Oe,v as ne,k as Ne,l as Ve,m as De,n as Ae,o as Ie,p as Re,q as $e,r as Be,s as He,t as re,w as Me,x as ce,y as ue,z as ze,e as $,b as I,c as y,u as je,Q as Le,A as de,d as G,f as fe}from"./use-quasar.ee3478cd.js";import{g as Ue}from"./scroll.40262c0e.js";import{Q as K,C as pe}from"./ClosePopup.b99c5183.js";import{api as N}from"./axios.00cf310b.js";const We=[v("g",{transform:"translate(1 1)","stroke-width":"2",fill:"none","fill-rule":"evenodd"},[v("circle",{cx:"5",cy:"50",r:"5"},[v("animate",{attributeName:"cy",begin:"0s",dur:"2.2s",values:"50;5;50;50",calcMode:"linear",repeatCount:"indefinite"}),v("animate",{attributeName:"cx",begin:"0s",dur:"2.2s",values:"5;27;49;5",calcMode:"linear",repeatCount:"indefinite"})]),v("circle",{cx:"27",cy:"5",r:"5"},[v("animate",{attributeName:"cy",begin:"0s",dur:"2.2s",from:"5",to:"5",values:"5;50;50;5",calcMode:"linear",repeatCount:"indefinite"}),v("animate",{attributeName:"cx",begin:"0s",dur:"2.2s",from:"27",to:"27",values:"27;49;5;27",calcMode:"linear",repeatCount:"indefinite"})]),v("circle",{cx:"49",cy:"50",r:"5"},[v("animate",{attributeName:"cy",begin:"0s",dur:"2.2s",values:"50;50;5;50",calcMode:"linear",repeatCount:"indefinite"}),v("animate",{attributeName:"cx",from:"49",to:"49",begin:"0s",dur:"2.2s",values:"49;5;27;49",calcMode:"linear",repeatCount:"indefinite"})])])];var Fe=H({name:"QSpinnerBall",props:Ce,setup(s){const{cSize:d,classes:c}=Se(s);return()=>v("svg",{class:c.value,stroke:"currentColor",width:d.value,height:d.value,viewBox:"0 0 57 57",xmlns:"http://www.w3.org/2000/svg"},We)}}),Ze=H({name:"QTooltip",inheritAttrs:!1,props:{...Ee,...Qe,...Oe,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{default:"jump-down"},transitionHide:{default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:ne},self:{type:String,default:"top middle",validator:ne},offset:{type:Array,default:()=>[14,14],validator:Ne},scrollTarget:{default:void 0},delay:{type:Number,default:0},hideDelay:{type:Number,default:0}},emits:[...Ve],setup(s,{slots:d,emit:c,attrs:a}){let m,p;const _=me(),{proxy:{$q:u}}=_,w=T(null),r=T(!1),V=S(()=>ue(s.anchor,u.lang.rtl)),M=S(()=>ue(s.self,u.lang.rtl)),z=S(()=>s.persistent!==!0),{registerTick:j,removeTick:L}=De(),{registerTimeout:O}=Ae(),{transitionProps:U,transitionStyle:W}=Ie(s),{localScrollTarget:R,changeScrollEvent:F,unconfigureScrollTarget:e}=Re(s,te),{anchorEl:i,canShow:n,anchorEvents:f}=$e({showing:r,configureAnchorEl:we}),{show:x,hide:D}=Be({showing:r,canShow:n,handleShow:be,handleHide:he,hideOnRouteChange:z,processOnMount:!0});Object.assign(f,{delayShow:ge,delayHide:ye});const{showPortal:X,hidePortal:Y,renderPortal:_e}=He(_,w,xe,"tooltip");if(u.platform.is.mobile===!0){const b={anchorEl:i,innerRef:w,onClickOutside(P){return D(P),P.target.classList.contains("q-dialog__backdrop")&&qe(P),!0}},Z=S(()=>s.modelValue===null&&s.persistent!==!0&&r.value===!0);ae(Z,P=>{(P===!0?ze:re)(b)}),se(()=>{re(b)})}function be(b){X(),j(()=>{p=new MutationObserver(()=>A()),p.observe(w.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),A(),te()}),m===void 0&&(m=ae(()=>u.screen.width+"|"+u.screen.height+"|"+s.self+"|"+s.anchor+"|"+u.lang.rtl,A)),O(()=>{X(!0),c("show",b)},s.transitionDuration)}function he(b){L(),Y(),ee(),O(()=>{Y(!0),c("hide",b)},s.transitionDuration)}function ee(){p!==void 0&&(p.disconnect(),p=void 0),m!==void 0&&(m(),m=void 0),e(),oe(f,"tooltipTemp")}function A(){Me({targetEl:w.value,offset:s.offset,anchorEl:i.value,anchorOrigin:V.value,selfOrigin:M.value,maxHeight:s.maxHeight,maxWidth:s.maxWidth})}function ge(b){if(u.platform.is.mobile===!0){ce(),document.body.classList.add("non-selectable");const Z=i.value,P=["touchmove","touchcancel","touchend","click"].map(le=>[Z,le,"delayHide","passiveCapture"]);ie(f,"tooltipTemp",P)}O(()=>{x(b)},s.delay)}function ye(b){u.platform.is.mobile===!0&&(oe(f,"tooltipTemp"),ce(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),O(()=>{D(b)},s.hideDelay)}function we(){if(s.noParentEvent===!0||i.value===null)return;const b=u.platform.is.mobile===!0?[[i.value,"touchstart","delayShow","passive"]]:[[i.value,"mouseenter","delayShow","passive"],[i.value,"mouseleave","delayHide","passive"]];ie(f,"anchor",b)}function te(){if(i.value!==null||s.scrollTarget!==void 0){R.value=Ue(i.value,s.scrollTarget);const b=s.noParentEvent===!0?A:D;F(R.value,b)}}function ke(){return r.value===!0?v("div",{...a,ref:w,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",a.class],style:[a.style,W.value],role:"tooltip"},B(d.default)):null}function xe(){return v(Te,U.value,ke)}return se(ee),Object.assign(_.proxy,{updatePosition:A}),_e}}),C=H({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(s,{slots:d}){const c=me(),a=S(()=>"q-td"+(s.autoWidth===!0?" q-table--col-auto-width":"")+(s.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(s.props===void 0)return v("td",{class:a.value},B(d.default));const m=c.vnode.key,p=(s.props.colsMap!==void 0?s.props.colsMap[m]:null)||s.props.col;if(p===void 0)return;const{row:_}=s.props;return v("td",{class:a.value+p.__tdClass(_),style:p.__tdStyle(_)},B(d.default))}}}),Je=H({name:"QTr",props:{props:Object,noHover:Boolean},setup(s,{slots:d}){const c=S(()=>"q-tr"+(s.props===void 0||s.props.header===!0?"":" "+s.props.__trClass)+(s.noHover===!0?" q-tr--no-hover":""));return()=>v("tr",{class:c.value},B(d.default))}});const Ge={__name:"QuotesArchive",props:{quotes:{default:[],type:Array}},emits:["restore","destroy"],setup(s,{emit:d}){const c=s;let a={0:{label:"Nueva",color:"text-pink"},1:{label:"Aprobada",color:"text-light-green-10"},2:{label:"Rechazada",color:"text-red-14"}},m=T({cols:[{name:"id",label:"ID"},{name:"client",label:"Cliente"},{name:"address",label:"Domicilio",field:u=>`${u.street}, ${u.num_ext}`},{name:"celphone",label:"Telefono"},{name:"email",label:"Correo"},{name:"price",label:"Precio"},{name:"tickets",label:"Ticket"},{name:"status",label:"Estado",field:u=>a[u._status].label,classes:u=>a[u._status].color},{name:"store",label:"Sucursal"},{name:"actions",label:"Actions"}]});const p=u=>{d("restore",u)},_=u=>{d("destroy",u)};return(u,w)=>(E(),Q(y,{class:"col"},{default:l(()=>[t($,{title:"Rechazadas",rows:o(c).quotes,"row-key":"name",columns:o(m).cols},{body:l(r=>[t(Je,{props:r},{default:l(()=>[t(C,{key:"id",props:r},{default:l(()=>[h(g(r.row.id),1)]),_:2},1032,["props"]),t(C,{key:"client",props:r},{default:l(()=>[h(g(r.row.nom_cli),1)]),_:2},1032,["props"]),t(C,{key:"address",props:r},{default:l(()=>[h(g(`${r.row.street}, ${r.row.num_ext}`),1)]),_:2},1032,["props"]),t(C,{key:"celphone",props:r},{default:l(()=>[h(g(r.row.celphone),1)]),_:2},1032,["props"]),t(C,{key:"email",props:r},{default:l(()=>[h(g(r.row.email),1)]),_:2},1032,["props"]),t(C,{key:"price",props:r},{default:l(()=>[h(g(r.row.price),1)]),_:2},1032,["props"]),t(C,{key:"tickets",props:r},{default:l(()=>[h(g(r.row.tickets),1)]),_:2},1032,["props"]),t(C,{key:"status",props:r,class:Pe(o(a)[r.row._status].color)},{default:l(()=>[h(g(o(a)[r.row._status].label),1)]),_:2},1032,["props","class"]),t(C,{key:"store",props:r},{default:l(()=>[h(g(r.row.sucursal),1)]),_:2},1032,["props"]),t(C,{key:"actions",props:r},{default:l(()=>[t(q,{flat:"",round:"",icon:"settings_backup_restore",color:"primary",onClick:V=>p(r.row.id),title:"Restaurar"},null,8,["onClick"]),t(q,{flat:"",round:"",icon:"delete_forever",color:"negative",onClick:V=>_(r.row.id),title:"Eliminar permanentemente"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),t(I,{class:"my-card"},{default:l(()=>[t(y,null,{default:l(()=>[t(K,null,{default:l(()=>[ve(t(q,{flat:"",label:"Cancelar"},null,512),[[pe]])]),_:1})]),_:1})]),_:1})]),_:1}))}},Ke={class:"full-width row justify-between item-center"},Xe=k("div",{class:"text-h5"},"Pendientes",-1),Ye={class:"full-width row justify-between item-center"},et=k("div",{class:"text-h5"},"Aceptadas",-1),tt={class:"full-width row justify-between item-center"},lt=k("div",{class:"text-h5"},"En Sucursales",-1),at={class:"text-h6"},st=k("div",{class:"text-h5 text-center"},"Cliente",-1),ot={class:"text-h4 text-center"},it={class:"text-subtitle2 text-center"},ft={__name:"History",setup(s){const d=je();let c=T([]),a=T({state:!1,row:null,pts:!1}),m={0:{label:"Nueva",color:"text-pink"},1:{label:"Aprobada",color:"text-light-green-10"},2:{label:"Rechazada",color:"text-red-14"},3:{label:"Sincronizadas",color:"text-deep-orange-10"},4:{label:"Eliminadas",color:"text-deep-orange-10"}},p=T({state:!1,row:null}),_=T({vcolumns:["client","celphone","price","status"],cols:[{name:"id",label:"ID",field:"id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>m[e._status].label,classes:e=>m[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"}],filter:""}),u=T({vcolumns:["client","celphone","price","status","idfs","ReplyStore"],cols:[{name:"id",label:"ID",field:"id"},{name:"idfs",label:"Factusol",field:"fs_id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>m[e._status].label,classes:e=>m[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"},{name:"ReplyStore",label:"ReplicadoEn:",field:"Stores"}],filter:""}),w=T({vcolumns:["client","celphone","price","status","idfs"],cols:[{name:"id",label:"ID",field:"id"},{name:"idfs",label:"Factusol",field:"fs_id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>m[e._status].label,classes:e=>m[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"}],filter:""}),r=S(()=>c.value.filter(e=>e._status==0)),V=S(()=>c.value.filter(e=>e._status==2)),M=S(()=>c.value.filter(e=>e._status==1)),z=S(()=>c.value.filter(e=>e._status==3));const j=async()=>{console.log("Traiendo solicitudes creadas");const e=await N.get("/admincli/solicitudes");console.log(e),c.value=e.data.solicitudes},L=(e,i)=>{console.log(i._status),a.value.row=i,a.value.state=!0},O=async()=>{a.value.pts=!0;let e=await N.post("/admincli/addClient",a.value.row).then(n=>n).catch(n=>n);if(console.log(e),e.request.status!=201){console.log("error brou"),console.log(e);let n=e.response.data.error.msg;a.value.pts=!1,d.notify({message:n,icon:"close",color:"negative"})}else{let n=e.data.id,f=c.value.findIndex(x=>x.id==n);c.value[f]._status=e.data._status,c.value[f].fs_id=e.data.fs_id,a.value.state=!1,a.value.pts=!1,d.notify({message:"Cliente Creado",icon:"check_circle",color:"positive"}),console.log(e)}},U=async()=>{a.value.pts=!0;let e=await N.patch("/admincli/ignoredClient",a.value.row),i=e.data.id,n=c.value.findIndex(f=>f.id==i);c.value[n]._status=e.data._status,a.value.state=!1,a.value.pts=!1,console.log(n),d.notify({message:"Cliente Ignorado",icon:"close",color:"danger"}),console.log(e)},W=async e=>{let i=await N.patch("/admincli/Restore",{id:e}),n=i.data.id,f=c.value.findIndex(x=>x.id==n);c.value[f]._status=i.data._status,d.notify({message:"Restaurado",icon:"check",color:"primary"}),console.log(i)},R=async e=>{console.log("amo a destruira "+e);let i=await N.patch("/admincli/Delete",{id:e}),n=i.data.id,f=c.value.findIndex(x=>x.id==n);c.value[f]._status=i.data._status,d.notify({message:"Eliminado",icon:"close",color:"negative"}),console.log(i)},F=async()=>{a.value.state=!0,a.value.pts=!0,console.log("SINCRONIZANDO CLIENTES");let e=await N.get("/admincli/syncClient").then(n=>n).catch(n=>n);console.log(e),e.request.status!=200?d.notify({message:"hubo problemas con la replicacion",icon:"close",color:"negative"}):(e.data.forEach(f=>{let x=c.value.findIndex(D=>D.id==f.id);c.value[x]._status=f._status,c.value[x].Stores=f.Stores}),a.value.state=!1,a.value.pts=!1,d.notify({message:"CLIENTES SINCRONIZADOS",icon:"check_circle",color:"positive"}))};return j(),(e,i)=>(E(),Q(Le,{padding:""},{default:l(()=>[t(I,{class:"my-card"},{default:l(()=>[t(y,{class:"text-right"},{default:l(()=>[t(q,{color:"negative",icon:"archive",label:"",onClick:i[0]||(i[0]=n=>o(p).state=!0)})]),_:1}),t(de),t(y,{horizontal:""},{default:l(()=>[t(y,{class:"col"},{default:l(()=>[t($,{title:"Solicitudes",rows:o(r),"row-key":"name",columns:o(_).cols,onRowClick:L,filter:o(_).filter,"visible-columns":o(_).vcolumns},{top:l(()=>[k("div",Ke,[Xe,t(G,{modelValue:o(_).filter,"onUpdate:modelValue":i[1]||(i[1]=n=>o(_).filter=n),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1}),t(y,{class:"col"},{default:l(()=>[t($,{title:"Aceptados",rows:o(M),columns:o(u).cols,"row-key":"name",filter:o(u).filter,"visible-columns":o(u).vcolumns},{top:l(()=>[k("div",Ye,[k("div",null,[t(q,{color:"positive",icon:"sync",onClick:F,disabled:"qts_acepted"})]),et,t(G,{modelValue:o(u).filter,"onUpdate:modelValue":i[2]||(i[2]=n=>o(u).filter=n),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1})]),_:1})]),_:1}),t(I,{class:"my-card"},{default:l(()=>[t(y,{class:"text-right"}),t(de),t(y,{horizontal:""},{default:l(()=>[t(y,{class:"col"},{default:l(()=>[t($,{title:"Terminadas",rows:o(z),"row-key":"name",columns:o(w).cols,filter:o(w).filter,"visible-columns":o(w).vcolumns},{top:l(()=>[k("div",tt,[lt,t(G,{modelValue:o(w).filter,"onUpdate:modelValue":i[3]||(i[3]=n=>o(w).filter=n),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1})]),_:1})]),_:1}),t(fe,{modelValue:o(a).state,"onUpdate:modelValue":i[4]||(i[4]=n=>o(a).state=n),persistent:o(a).pts},{default:l(()=>[o(a).pts?(E(),Q(I,{key:0},{default:l(()=>[t(y,null,{default:l(()=>[t(Fe,{color:"primary",size:"md"}),t(Ze,{offset:[0,8]},{default:l(()=>[h("QSpinnerBall")]),_:1})]),_:1})]),_:1})):(E(),Q(I,{key:1},{default:l(()=>[o(a).row._status==0?(E(),Q(y,{key:0},{default:l(()=>[k("div",at,"Solicitud: "+g(o(a).row.id),1),st,k("div",ot,g(o(a).row.nom_cli),1),k("div",it,"Sucursal: "+g(o(a).row.sucursal),1),t(K,{align:"right"},{default:l(()=>[t(q,{flat:"",onClick:U},{default:l(()=>[h("Rechazar")]),_:1}),t(q,{flat:"",onClick:O},{default:l(()=>[h("Aprobar")]),_:1})]),_:1})]),_:1})):J("",!0),o(a).row._status==1?(E(),Q(y,{key:1},{default:l(()=>[h(g(o(a).row)+" - 1 ",1)]),_:1})):J("",!0),o(a).row._status==2?(E(),Q(y,{key:2},{default:l(()=>[h(g(o(a).row)+" - 2 ",1)]),_:1})):J("",!0),t(K,null,{default:l(()=>[ve(t(q,{flat:"",label:"Cancelar"},null,512),[[pe]])]),_:1})]),_:1}))]),_:1},8,["modelValue","persistent"]),t(fe,{modelValue:o(p).state,"onUpdate:modelValue":i[5]||(i[5]=n=>o(p).state=n),persistent:""},{default:l(()=>[t(Ge,{quotes:o(V),onRestore:W,onDestroy:R},null,8,["quotes"])]),_:1},8,["modelValue"])]),_:1}))}};export{ft as default};
