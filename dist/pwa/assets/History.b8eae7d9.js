import{f as m,c as A,ar as X,as as Y,d as T,t as E,g as ee,r as C,k as S,m as Q,n as l,p as t,L as a,q as f,at as p,au as te,Q as x,av as P,s as b,O as $}from"./index.6ea3e414.js";import{e as I,b as V,c as _,u as le,Q as ae,h as z,d as B,f as M}from"./use-quasar.6cf1315e.js";import{Q as R,C as O,a as se}from"./ClosePopup.cfb129da.js";import{api as N}from"./axios.41f2f890.js";import"./scroll.bd9a67bd.js";const oe=[m("g",{transform:"translate(1 1)","stroke-width":"2",fill:"none","fill-rule":"evenodd"},[m("circle",{cx:"5",cy:"50",r:"5"},[m("animate",{attributeName:"cy",begin:"0s",dur:"2.2s",values:"50;5;50;50",calcMode:"linear",repeatCount:"indefinite"}),m("animate",{attributeName:"cx",begin:"0s",dur:"2.2s",values:"5;27;49;5",calcMode:"linear",repeatCount:"indefinite"})]),m("circle",{cx:"27",cy:"5",r:"5"},[m("animate",{attributeName:"cy",begin:"0s",dur:"2.2s",from:"5",to:"5",values:"5;50;50;5",calcMode:"linear",repeatCount:"indefinite"}),m("animate",{attributeName:"cx",begin:"0s",dur:"2.2s",from:"27",to:"27",values:"27;49;5;27",calcMode:"linear",repeatCount:"indefinite"})]),m("circle",{cx:"49",cy:"50",r:"5"},[m("animate",{attributeName:"cy",begin:"0s",dur:"2.2s",values:"50;50;5;50",calcMode:"linear",repeatCount:"indefinite"}),m("animate",{attributeName:"cx",from:"49",to:"49",begin:"0s",dur:"2.2s",values:"49;5;27;49",calcMode:"linear",repeatCount:"indefinite"})])])];var ie=A({name:"QSpinnerBall",props:X,setup(u){const{cSize:c,classes:r}=Y(u);return()=>m("svg",{class:r.value,stroke:"currentColor",width:c.value,height:c.value,viewBox:"0 0 57 57",xmlns:"http://www.w3.org/2000/svg"},oe)}}),g=A({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(u,{slots:c}){const r=ee(),s=T(()=>"q-td"+(u.autoWidth===!0?" q-table--col-auto-width":"")+(u.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(u.props===void 0)return m("td",{class:s.value},E(c.default));const y=r.vnode.key,h=(u.props.colsMap!==void 0?u.props.colsMap[y]:null)||u.props.col;if(h===void 0)return;const{row:w}=u.props;return m("td",{class:s.value+h.__tdClass(w),style:h.__tdStyle(w)},E(c.default))}}}),ne=A({name:"QTr",props:{props:Object,noHover:Boolean},setup(u,{slots:c}){const r=T(()=>"q-tr"+(u.props===void 0||u.props.header===!0?"":" "+u.props.__trClass)+(u.noHover===!0?" q-tr--no-hover":""));return()=>m("tr",{class:r.value},E(c.default))}});const re={__name:"QuotesArchive",props:{quotes:{default:[],type:Array}},emits:["restore","destroy"],setup(u,{emit:c}){const r=u;let s={0:{label:"Nueva",color:"text-pink"},1:{label:"Aprobada",color:"text-light-green-10"},2:{label:"Rechazada",color:"text-red-14"}},y=C({cols:[{name:"id",label:"ID"},{name:"client",label:"Cliente"},{name:"address",label:"Domicilio",field:d=>`${d.street}, ${d.num_ext}`},{name:"celphone",label:"Telefono"},{name:"email",label:"Correo"},{name:"price",label:"Precio"},{name:"tickets",label:"Ticket"},{name:"status",label:"Estado",field:d=>s[d._status].label,classes:d=>s[d._status].color},{name:"store",label:"Sucursal"},{name:"actions",label:"Actions"}]});const h=d=>{c("restore",d)},w=d=>{c("destroy",d)};return(d,q)=>(S(),Q(_,{class:"col"},{default:l(()=>[t(I,{title:"Rechazadas",rows:a(r).quotes,"row-key":"name",columns:a(y).cols},{body:l(n=>[t(ne,{props:n},{default:l(()=>[t(g,{key:"id",props:n},{default:l(()=>[f(p(n.row.id),1)]),_:2},1032,["props"]),t(g,{key:"client",props:n},{default:l(()=>[f(p(n.row.nom_cli),1)]),_:2},1032,["props"]),t(g,{key:"address",props:n},{default:l(()=>[f(p(`${n.row.street}, ${n.row.num_ext}`),1)]),_:2},1032,["props"]),t(g,{key:"celphone",props:n},{default:l(()=>[f(p(n.row.celphone),1)]),_:2},1032,["props"]),t(g,{key:"email",props:n},{default:l(()=>[f(p(n.row.email),1)]),_:2},1032,["props"]),t(g,{key:"price",props:n},{default:l(()=>[f(p(n.row.price),1)]),_:2},1032,["props"]),t(g,{key:"tickets",props:n},{default:l(()=>[f(p(n.row.tickets),1)]),_:2},1032,["props"]),t(g,{key:"status",props:n,class:te(a(s)[n.row._status].color)},{default:l(()=>[f(p(a(s)[n.row._status].label),1)]),_:2},1032,["props","class"]),t(g,{key:"store",props:n},{default:l(()=>[f(p(n.row.sucursal),1)]),_:2},1032,["props"]),t(g,{key:"actions",props:n},{default:l(()=>[t(x,{flat:"",round:"",icon:"settings_backup_restore",color:"primary",onClick:D=>h(n.row.id),title:"Restaurar"},null,8,["onClick"]),t(x,{flat:"",round:"",icon:"delete_forever",color:"negative",onClick:D=>w(n.row.id),title:"Eliminar permanentemente"},null,8,["onClick"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),t(V,{class:"my-card"},{default:l(()=>[t(_,null,{default:l(()=>[t(R,null,{default:l(()=>[P(t(x,{flat:"",label:"Cancelar"},null,512),[[O]])]),_:1})]),_:1})]),_:1})]),_:1}))}},ce={class:"full-width row justify-between item-center"},ue=b("div",{class:"text-h5"},"Pendientes",-1),de={class:"full-width row justify-between item-center"},me=b("div",{class:"text-h5"},"Aceptadas",-1),fe={class:"full-width row justify-between item-center"},pe=b("div",{class:"text-h5"},"En Sucursales",-1),_e={class:"text-h6"},ve=b("div",{class:"text-h5 text-center"},"Cliente",-1),be={class:"text-h4 text-center"},ye={class:"text-subtitle2 text-center"},Ce={__name:"History",setup(u){const c=le();let r=C([]),s=C({state:!1,row:null,pts:!1}),y={0:{label:"Nueva",color:"text-pink"},1:{label:"Aprobada",color:"text-light-green-10"},2:{label:"Rechazada",color:"text-red-14"},3:{label:"Sincronizadas",color:"text-deep-orange-10"},4:{label:"Eliminadas",color:"text-deep-orange-10"}},h=C({state:!1,row:null}),w=C({vcolumns:["client","celphone","price","status"],cols:[{name:"id",label:"ID",field:"id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>y[e._status].label,classes:e=>y[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"}],filter:""}),d=C({vcolumns:["client","celphone","price","status","idfs","ReplyStore"],cols:[{name:"id",label:"ID",field:"id"},{name:"idfs",label:"Factusol",field:"fs_id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>y[e._status].label,classes:e=>y[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"},{name:"ReplyStore",label:"ReplicadoEn:",field:"Stores"}],filter:""}),q=C({vcolumns:["client","celphone","price","status","idfs"],cols:[{name:"id",label:"ID",field:"id"},{name:"idfs",label:"Factusol",field:"fs_id"},{name:"client",label:"Cliente",field:"nom_cli"},{name:"address",label:"Domicilio",field:e=>`${e.street}, ${e.num_ext}`},{name:"celphone",label:"Telefono",field:"celphone"},{name:"email",label:"Correo",field:"email"},{name:"price",label:"Precio",field:"price"},{name:"tickets",label:"Ticket",field:"tickets"},{name:"status",label:"Estado",field:e=>y[e._status].label,classes:e=>y[e._status].color},{name:"store",label:"Sucursal",field:"sucursal"}],filter:""}),n=T(()=>r.value.filter(e=>e._status==0)),D=T(()=>r.value.filter(e=>e._status==2)),j=T(()=>r.value.filter(e=>e._status==1)),H=T(()=>r.value.filter(e=>e._status==3));const U=async()=>{console.log("Traiendo solicitudes creadas");const e=await N.get("/admincli/solicitudes");console.log(e),r.value=e.data.solicitudes},L=(e,i)=>{console.log(i._status),s.value.row=i,s.value.state=!0},F=async()=>{s.value.pts=!0;let e=await N.post("/admincli/addClient",s.value.row).then(o=>o).catch(o=>o);if(console.log(e),e.request.status!=201){console.log("error brou"),console.log(e);let o=e.response.data.error.msg;s.value.pts=!1,c.notify({message:o,icon:"close",color:"negative"})}else{let o=e.data.id,v=r.value.findIndex(k=>k.id==o);r.value[v]._status=e.data._status,r.value[v].fs_id=e.data.fs_id,s.value.state=!1,s.value.pts=!1,c.notify({message:"Cliente Creado",icon:"check_circle",color:"positive"}),console.log(e)}},W=async()=>{s.value.pts=!0;let e=await N.patch("/admincli/ignoredClient",s.value.row),i=e.data.id,o=r.value.findIndex(v=>v.id==i);r.value[o]._status=e.data._status,s.value.state=!1,s.value.pts=!1,console.log(o),c.notify({message:"Cliente Ignorado",icon:"close",color:"danger"}),console.log(e)},Z=async e=>{let i=await N.patch("/admincli/Restore",{id:e}),o=i.data.id,v=r.value.findIndex(k=>k.id==o);r.value[v]._status=i.data._status,c.notify({message:"Restaurado",icon:"check",color:"primary"}),console.log(i)},G=async e=>{console.log("amo a destruira "+e);let i=await N.patch("/admincli/Delete",{id:e}),o=i.data.id,v=r.value.findIndex(k=>k.id==o);r.value[v]._status=i.data._status,c.notify({message:"Eliminado",icon:"close",color:"negative"}),console.log(i)},J=async()=>{s.value.state=!0,s.value.pts=!0,console.log("SINCRONIZANDO CLIENTES");let e=await N.get("/admincli/syncClient").then(o=>o).catch(o=>o);console.log(e),e.request.status!=200?c.notify({message:"hubo problemas con la replicacion",icon:"close",color:"negative"}):(e.data.forEach(v=>{let k=r.value.findIndex(K=>K.id==v.id);r.value[k]._status=v._status,r.value[k].Stores=v.Stores}),s.value.state=!1,s.value.pts=!1,c.notify({message:"CLIENTES SINCRONIZADOS",icon:"check_circle",color:"positive"}))};return U(),(e,i)=>(S(),Q(ae,{padding:""},{default:l(()=>[t(V,{class:"my-card"},{default:l(()=>[t(_,{class:"text-right"},{default:l(()=>[t(x,{color:"negative",icon:"archive",label:"",onClick:i[0]||(i[0]=o=>a(h).state=!0)})]),_:1}),t(z),t(_,{horizontal:""},{default:l(()=>[t(_,{class:"col"},{default:l(()=>[t(I,{title:"Solicitudes",rows:a(n),"row-key":"name",columns:a(w).cols,onRowClick:L,filter:a(w).filter,"visible-columns":a(w).vcolumns},{top:l(()=>[b("div",ce,[ue,t(B,{modelValue:a(w).filter,"onUpdate:modelValue":i[1]||(i[1]=o=>a(w).filter=o),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1}),t(_,{class:"col"},{default:l(()=>[t(I,{title:"Aceptados",rows:a(j),columns:a(d).cols,"row-key":"name",filter:a(d).filter,"visible-columns":a(d).vcolumns},{top:l(()=>[b("div",de,[b("div",null,[t(x,{color:"positive",icon:"sync",onClick:J,disabled:"qts_acepted"})]),me,t(B,{modelValue:a(d).filter,"onUpdate:modelValue":i[2]||(i[2]=o=>a(d).filter=o),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1})]),_:1})]),_:1}),t(V,{class:"my-card"},{default:l(()=>[t(_,{class:"text-right"}),t(z),t(_,{horizontal:""},{default:l(()=>[t(_,{class:"col"},{default:l(()=>[t(I,{title:"Terminadas",rows:a(H),"row-key":"name",columns:a(q).cols,filter:a(q).filter,"visible-columns":a(q).vcolumns},{top:l(()=>[b("div",fe,[pe,t(B,{modelValue:a(q).filter,"onUpdate:modelValue":i[3]||(i[3]=o=>a(q).filter=o),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter","visible-columns"])]),_:1})]),_:1})]),_:1}),t(M,{modelValue:a(s).state,"onUpdate:modelValue":i[4]||(i[4]=o=>a(s).state=o),persistent:a(s).pts},{default:l(()=>[a(s).pts?(S(),Q(V,{key:0},{default:l(()=>[t(_,null,{default:l(()=>[t(ie,{color:"primary",size:"md"}),t(se,{offset:[0,8]},{default:l(()=>[f("QSpinnerBall")]),_:1})]),_:1})]),_:1})):(S(),Q(V,{key:1},{default:l(()=>[a(s).row._status==0?(S(),Q(_,{key:0},{default:l(()=>[b("div",_e,"Solicitud: "+p(a(s).row.id),1),ve,b("div",be,p(a(s).row.nom_cli),1),b("div",ye,"Sucursal: "+p(a(s).row.sucursal),1),t(R,{align:"right"},{default:l(()=>[t(x,{flat:"",onClick:W},{default:l(()=>[f("Rechazar")]),_:1}),t(x,{flat:"",onClick:F},{default:l(()=>[f("Aprobar")]),_:1})]),_:1})]),_:1})):$("",!0),a(s).row._status==1?(S(),Q(_,{key:1},{default:l(()=>[f(p(a(s).row)+" - 1 ",1)]),_:1})):$("",!0),a(s).row._status==2?(S(),Q(_,{key:2},{default:l(()=>[f(p(a(s).row)+" - 2 ",1)]),_:1})):$("",!0),t(R,null,{default:l(()=>[P(t(x,{flat:"",label:"Cancelar"},null,512),[[O]])]),_:1})]),_:1}))]),_:1},8,["modelValue","persistent"]),t(M,{modelValue:a(h).state,"onUpdate:modelValue":i[5]||(i[5]=o=>a(h).state=o),persistent:""},{default:l(()=>[t(re,{quotes:a(D),onRestore:Z,onDestroy:G},null,8,["quotes"])]),_:1},8,["modelValue"])]),_:1}))}};export{Ce as default};
