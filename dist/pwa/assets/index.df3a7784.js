import{Q as X}from"./QBadge.91d85870.js";import{u as Z,Q as ee,c as L,f as W,b as B,o as q,e as le,k as Y,K as j,L as r,M as n,d as D}from"./use-quasar.e924c61d.js";import{c as te,o as ae,f as ne,V as oe,r as E,k as p,m as I,n as t,p as e,s as N,q as o,L as k,at as v,O as se,Q as S,av as H,aC as z,N as A,aA as K,aB as G}from"./index.6986e83f.js";import{Q as ie,C as ue}from"./ClosePopup.60b40675.js";import{api as $}from"./axios.ad4ec065.js";import"./scroll.f63e12c0.js";var J=te({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(T,{slots:x,emit:R}){let V=!1,h,y,w=null,m=null,u,C;function g(){h&&h(),h=null,V=!1,w!==null&&(clearTimeout(w),w=null),m!==null&&(clearTimeout(m),m=null),y!==void 0&&y.removeEventListener("transitionend",u),u=null}function O(i,b,U){b!==void 0&&(i.style.height=`${b}px`),i.style.transition=`height ${T.duration}ms cubic-bezier(.25, .8, .50, 1)`,V=!0,h=U}function F(i,b){i.style.overflowY=null,i.style.height=null,i.style.transition=null,g(),b!==C&&R(b)}function P(i,b){let U=0;y=i,V===!0?(g(),U=i.offsetHeight===i.scrollHeight?0:void 0):(C="hide",i.style.overflowY="hidden"),O(i,U,b),w=setTimeout(()=>{w=null,i.style.height=`${i.scrollHeight}px`,u=Q=>{m=null,(Object(Q)!==Q||Q.target===i)&&F(i,"show")},i.addEventListener("transitionend",u),m=setTimeout(u,T.duration*1.1)},100)}function M(i,b){let U;y=i,V===!0?g():(C="show",i.style.overflowY="hidden",U=i.scrollHeight),O(i,U,b),w=setTimeout(()=>{w=null,i.style.height=0,u=Q=>{m=null,(Object(Q)!==Q||Q.target===i)&&F(i,"hide")},i.addEventListener("transitionend",u),m=setTimeout(u,T.duration*1.1)},100)}return ae(()=>{V===!0&&g()}),()=>ne(oe,{css:!1,appear:T.appear,onEnter:P,onLeave:M},x.default)}});const de={class:"text-h4"},re={class:"text-h6 text-center"},ce={class:"text-h6 text-center"},fe={class:"text-h6 text-center"},pe=N("div",{class:"text-h6"},"Seleccione Destino",-1),ke={__name:"index",setup(T){const x=Z(),R=E(!0),V=E(!0),h=E(!0);let y=E({val:null,opts:[]}),w=E([]),m=E({state:!1,cols:[],filter:""}),u=E({state:!1,cols:[],filter:""});const C=E({state:!1,cols:[],filter:""});let g=E({val:null,opts:null});const O=E({promp:!1,body:null}),F=async()=>{console.log("Cargando Sucursales");const d=await $.get("/abonos/getSuc").then(a=>a).catch(a=>a);d.request.status!=200?console.log(d.response.data):(console.log(d),w.value=d.data,y.value.opts=d.data,g.value.opts=d.data)},P=async d=>{console.log(d.id);let a=d.id,l=await $.post("/abonos/gettras",{id:a});console.log(l.data);let f=l.data.devoluciones,_=l.data.movimientos.map(c=>c.refund);m.value.cols=f.filter(c=>!_.includes(c.DEVOLUCION)),m.value.state=!0,u.value.cols=l.data.movimientos.filter(c=>c.season_ticket==null||c.invoice==null||c.entry==null),C.value.cols=l.data.movimientos.filter(c=>c.season_ticket!=null&&c.invoice!=null&&c.entry!=null)},M=d=>{console.log(d),O.value.promp=!0,O.value.body=d},i=async()=>{console.log("iniciar");let d={from:y.value.val,to:g.value.val,devolucion:O.value.body};console.log(d);let a=await $.post("/abonos/iniproces",d);if(console.log(a),a.request.status!=200){console.log("error brou"),console.log(a);let f=a.response.data.error.msg;x.notify({message:f,icon:"close",color:"negative"})}else{O.value.promp=!1,g.value.val=null,x.notify({message:"Se Inicio",icon:"check_circle",color:"positive",position:"center"}),a.data.season_ticket!=null&&a.data.invoice!=null&&a.data.entry!=null?C.value.cols.push(a.data):(a.data.season_ticket==null||a.data.invoice==null||a.data.entry==null)&&u.value.cols.push(a.data);let f=m.value.cols.findIndex(s=>s.DEVOLUCION==a.data.refund);m.value.cols.splice(f,1)}},b=async d=>{let a=d,l=await $.post("/abonos/nabo",a);if(console.log(l),l.request.status!=200){console.log("error brou"),console.log(l);let s=l.response.data.error.msg;x.notify({message:s,icon:"close",color:"negative"})}else{let s=l.data.season_ticket;x.notify({message:`Abono Creado ${s}`,icon:"check_circle",color:"positive",position:"center"});let _=u.value.cols.findIndex(c=>c.id==l.data.id);l.data.season_ticket!=null&&l.data.invoice!=null&&l.data.entry!=null?(C.value.cols.push(l.data),u.value.cols.splice(_,1)):(l.data.season_ticket!=null||l.data.invoice==null||l.data.entry==null)&&(u.value.cols[_].season_ticket=l.data.season_ticket,console.log(u.value.cols[_].season_ticket))}},U=async d=>{console.log(d);let a=d;console.log(a);let l=await $.post("/abonos/ninv",a);if(console.log(l),l.request.status!=200){console.log("error brou"),console.log(l);let s=l.response.data.error.msg;x.notify({message:s,icon:"close",color:"negative"})}else{let s=l.data.invoice;x.notify({message:`Salida Creada ${s}`,icon:"check_circle",color:"positive",position:"center"});let _=u.value.cols.findIndex(c=>c.id==l.data.id);l.data.season_ticket!=null&&l.data.invoice!=null&&l.data.entry!=null?(C.value.cols.push(l.data),u.value.cols.splice(_,1)):(l.data.invoice!=null||l.data.season_ticket==null||l.data.entry==null)&&(u.value.cols[_].invoice=l.data.invoice,console.log(u.value.cols[_].invoice))}},Q=async d=>{console.log(d);let a=d;console.log(a);let l=await $.post("/abonos/nent",a);if(console.log(l),l.request.status!=200){console.log("error brou"),console.log(l);let s=l.response.data.error.msg;x.notify({message:s,icon:"close",color:"negative"})}else{let s=l.data.entry;x.notify({message:`Entrada Creada ${s}`,icon:"check_circle",color:"positive",position:"center"});let _=u.value.cols.findIndex(c=>c.id==l.data.id);l.data.season_ticket!=null&&l.data.invoice!=null&&l.data.entry!=null?(C.value.cols.push(l.data),u.value.cols.splice(_,1)):(l.data.entry!=null||l.data.invoice==null||l.data.season_ticket==null)&&(u.value.cols[_].entry=l.data.entry,console.log(u.value.cols[_].entry))}};return F(),(d,a)=>(p(),I(ee,{padding:""},{default:t(()=>[e(B,{class:"my-card row"},{default:t(()=>[e(L,null,{default:t(()=>[N("div",de,[o(" Traspasos "),k(y).val?(p(),I(X,{key:0,align:"top"},{default:t(()=>[o(v(k(y).val.name),1)]),_:1})):se("",!0)])]),_:1}),e(L,null,{default:t(()=>[e(W,{filled:"",modelValue:k(y).val,"onUpdate:modelValue":[a[0]||(a[0]=l=>k(y).val=l),P],"option-label":"name","input-debounce":"0",label:"Sucursal",options:k(y).opts,style:{width:"250px"},behavior:"menu"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(q,{spaced:"",inset:"",vertical:"",dark:""}),e(B,{class:"my-card"},{default:t(()=>[e(L,null,{default:t(()=>[N("div",re,[o("Sin Movimiento "),e(S,{color:"grey",round:"",flat:"",dense:"",icon:R.value?"keyboard_arrow_up":"keyboard_arrow_down",onClick:a[1]||(a[1]=l=>R.value=!R.value)},null,8,["icon"])])]),_:1}),e(J,null,{default:t(()=>[H(N("div",null,[(p(!0),A(G,null,K(k(m).cols,(l,f)=>(p(),A("div",{key:f},[e(Y,{bordered:""},{default:t(()=>[e(j,null,{default:t(()=>[e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" DEVOLUCION")]),_:1}),e(n,null,{default:t(()=>[o(v(l.DEVOLUCION),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" REFERENCIA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.REFERENCIA),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" PROVEEDOR")]),_:1}),e(n,null,{default:t(()=>[o(v(l.PROVEEDOR),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" FECHA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.FECHA),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,null,{default:t(()=>[e(S,{color:"primary",flat:"",label:"Iniciar",icon:"send",onClick:s=>M(l)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(q,{spaced:"",inset:"",vertical:"",dark:""})]))),128))],512),[[z,R.value]])]),_:1})]),_:1}),e(B,{class:"my-card"},{default:t(()=>[e(L,null,{default:t(()=>[N("div",ce,[o("Con Movimiento "),e(S,{color:"grey",round:"",flat:"",dense:"",icon:V.value?"keyboard_arrow_up":"keyboard_arrow_down",onClick:a[2]||(a[2]=l=>V.value=!V.value)},null,8,["icon"])])]),_:1}),e(J),H(N("div",null,[(p(!0),A(G,null,K(k(u).cols,(l,f)=>(p(),A("div",{key:f},[e(Y,{bordered:""},{default:t(()=>[e(j,null,{default:t(()=>[e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" DEVOLUCION")]),_:1}),e(n,null,{default:t(()=>[o(v(l.refund),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" REFERENCIA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.reference),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" PROVEEDOR")]),_:1}),e(n,null,{default:t(()=>[o(v(l.provider),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" FECHA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.created_at),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" ABONOS ")]),_:1}),l.season_ticket==null?(p(),I(n,{key:0},{default:t(()=>[e(S,{color:"primary",flat:"",label:"Abono",onClick:s=>b(l)},null,8,["onClick"])]),_:2},1024)):(p(),I(n,{key:1},{default:t(()=>[e(D,{dense:"",filled:"","item-aligned":!0,modelValue:l.season_ticket,"onUpdate:modelValue":s=>l.season_ticket=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" Salida ")]),_:1}),l.invoice==null?(p(),I(n,{key:0},{default:t(()=>[e(S,{color:"primary",flat:"",label:"Salida",onClick:s=>U(l)},null,8,["onClick"])]),_:2},1024)):(p(),I(n,{key:1},{default:t(()=>[e(D,{dense:"",filled:"","item-aligned":!0,modelValue:l.invoice,"onUpdate:modelValue":s=>l.invoice=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" Entrada ")]),_:1}),l.entry==null?(p(),I(n,{key:0},{default:t(()=>[e(S,{color:"primary",flat:"",label:"Entrada",onClick:s=>Q(l)},null,8,["onClick"])]),_:2},1024)):(p(),I(n,{key:1},{default:t(()=>[e(D,{dense:"",filled:"","item-aligned":!0,modelValue:l.entry,"onUpdate:modelValue":s=>l.entry=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))]),_:2},1024)]),_:2},1024)]),_:2},1024),e(q,{spaced:"",inset:"",vertical:"",dark:""})]))),128))],512),[[z,V.value]])]),_:1}),e(B,{class:"my-card"},{default:t(()=>[e(L,null,{default:t(()=>[N("div",fe,[o("Terminadas "),e(S,{color:"grey",round:"",flat:"",dense:"",icon:h.value?"keyboard_arrow_up":"keyboard_arrow_down",onClick:a[3]||(a[3]=l=>h.value=!h.value)},null,8,["icon"])])]),_:1}),e(J,null,{default:t(()=>[H(N("div",null,[(p(!0),A(G,null,K(C.value.cols,(l,f)=>(p(),A("div",{key:f},[e(Y,{bordered:""},{default:t(()=>[e(j,null,{default:t(()=>[e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" DEVOLUCION")]),_:1}),e(n,null,{default:t(()=>[o(v(l.refund),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" REFERENCIA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.reference),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" PROVEEDOR")]),_:1}),e(n,null,{default:t(()=>[o(v(l.provider),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" FECHA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.created_at),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" ABONOS ")]),_:1}),e(n,null,{default:t(()=>[e(D,{dense:"",filled:"","item-aligned":!0,modelValue:l.season_ticket,"onUpdate:modelValue":s=>l.season_ticket=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" Salida ")]),_:1}),e(n,null,{default:t(()=>[e(D,{dense:"",filled:"","item-aligned":!0,modelValue:l.invoice,"onUpdate:modelValue":s=>l.invoice=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" Entrada ")]),_:1}),e(n,null,{default:t(()=>[e(D,{dense:"",filled:"","item-aligned":!0,modelValue:l.entry,"onUpdate:modelValue":s=>l.entry=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(q,{spaced:"",inset:"",vertical:"",dark:""})]))),128))],512),[[z,h.value]])]),_:1})]),_:1}),e(le,{modelValue:O.value.promp,"onUpdate:modelValue":a[5]||(a[5]=l=>O.value.promp=l),persistent:""},{default:t(()=>[e(B,{style:{"min-width":"350px"}},{default:t(()=>[e(L,null,{default:t(()=>[pe]),_:1}),e(L,{class:"q-pt-none"},{default:t(()=>[e(W,{filled:"",modelValue:k(g).val,"onUpdate:modelValue":a[4]||(a[4]=l=>k(g).val=l),"option-label":"name",label:"Sucursal Destino",options:k(g).opts},null,8,["modelValue","options"])]),_:1}),e(ie,{align:"right"},{default:t(()=>[H(e(S,{flat:"",icon:"close",color:"negative"},null,512),[[ue]]),e(S,{flat:"",icon:"arrow_forward",color:"positive",title:"Traspasar",disable:k(g).val==null,onClick:i},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{ke as default};
