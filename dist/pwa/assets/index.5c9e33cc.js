import{Q as J}from"./QBadge.119e7df6.js";import{u as K,Q as M,c as p,f as A,b as h,o as _,d as b,e as Q}from"./use-quasar.a497a39f.js";import{r as c,d as g,k as u,m as x,n as t,p as e,s as f,q as y,L as a,at as v,O as m,N as w,av as T,Q as k}from"./index.25c2dd7a.js";import{Q as I,C as S}from"./ClosePopup.9fc23923.js";import{api as V}from"./axios.50ee3213.js";import"./scroll.b065d4d1.js";const W={class:"text-h4"},X={key:0},Y={key:1},$={key:2},ee={key:3},oe={class:"text-h6"},ae={class:"text-subtitle2"},le={class:"text-subtitle2"},te=f("div",{class:"text-h6"},"Seleccione Destino",-1),ve={__name:"index",setup(se){K();let d=c({val:null,opts:[]}),R=c([]),i=c({state:!1,cols:[],filter:""}),s=c({state:!1,body:null,promp:!1}),r=c({val:null,opts:null}),D=c([]);const B=g(()=>i.value.cols.filter(o=>o.TRAZABILIDAD.includes("abono"))),N=g(()=>i.value.cols.filter(o=>o.TRAZABILIDAD.includes("salida"))),E=g(()=>i.value.cols.filter(o=>o.TRAZABILIDAD.includes("entrada"))),L=g(()=>i.value.cols.filter(o=>o.TRAZABILIDAD=="")),O=async()=>{console.log("Cargando Sucursales");const o=await V.get("/abonos/getSuc").then(l=>l).catch(l=>l);o.request.status!=200?console.log(o.response.data):(console.log(o),R.value=o.data,d.value.opts=o.data,r.value.opts=o.data)},U=async o=>{console.log(o.id);let l=o.id,n=await V.post("/abonos/gettras",{id:l});console.log(n.data);let z=n.data.devoluciones,G=n.data.movimientos.map(C=>C.refund);i.value.cols=z.filter(C=>!G.includes(C.DEVOLUCION)),i.value.state=!0},Z=(o,l)=>{console.log(l),s.value.state=!0,s.value.body=l},q=()=>{s.value.promp=!0},F=async()=>{console.log("iniciar");let o={from:d.value.val,to:r.value.val,devolucion:s.value.body.DEVOLUCION},l=await V.post("/abonos/iniproces",o);console.log(l),D.value=l.data},P=()=>console.log("ahoritacontinuo"),H=()=>console.log("ahoritasigo"),j=()=>console.log("ahoritatermino");return O(),(o,l)=>(u(),x(M,{padding:""},{default:t(()=>[e(h,{class:"my-card row"},{default:t(()=>[e(p,null,{default:t(()=>[f("div",W,[y(" Traspasos "),a(d).val?(u(),x(J,{key:0,align:"top"},{default:t(()=>[y(v(a(d).val.name),1)]),_:1})):m("",!0)])]),_:1}),e(p,null,{default:t(()=>[e(A,{filled:"",modelValue:a(d).val,"onUpdate:modelValue":[l[0]||(l[0]=n=>a(d).val=n),U],"option-label":"name","input-debounce":"0",label:"Sucursal",options:a(d).opts,style:{width:"250px"},behavior:"menu"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(_,{spaced:"",inset:"",vertical:"",dark:""}),y(" "+v(a(D))+" ",1),a(i).state?(u(),w("div",X,[e(b,{title:"Traspasos Pendientes",rows:L.value,onRowClick:Z},null,8,["rows"])])):m("",!0),e(_,{spaced:"",inset:"",vertical:"",dark:""}),a(i).state?(u(),w("div",Y,[e(b,{title:"Traspasos Solo Abono",rows:B.value,onRowClick:P},null,8,["rows"])])):m("",!0),e(_,{spaced:"",inset:"",vertical:"",dark:""}),a(i).state?(u(),w("div",$,[e(b,{title:"Traspasos Solo Salida",rows:N.value,onRowClick:H},null,8,["rows"])])):m("",!0),e(_,{spaced:"",inset:"",vertical:"",dark:""}),a(i).state?(u(),w("div",ee,[e(b,{title:"Traspasos Completados",rows:E.value,onRowClick:j},null,8,["rows"])])):m("",!0),e(Q,{modelValue:a(s).state,"onUpdate:modelValue":l[1]||(l[1]=n=>a(s).state=n),persistent:""},{default:t(()=>[e(h,{class:"my-card"},{default:t(()=>[e(p,null,{default:t(()=>[f("div",oe,"Devolucion : "+v(a(s).body.DEVOLUCION),1),f("div",ae,"Referencia: "+v(a(s).body.REFERENCIA),1),f("div",le,"Fecha: "+v(a(s).body.FECHA),1)]),_:1}),e(I,{align:"right"},{default:t(()=>[T(e(k,{flat:"",icon:"close",color:"negative",title:"cancelar"},null,512),[[S]]),e(k,{flat:"",icon:"arrow_forward",color:"positive",title:"Traspasar",onClick:q})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Q,{modelValue:a(s).promp,"onUpdate:modelValue":l[3]||(l[3]=n=>a(s).promp=n),persistent:""},{default:t(()=>[e(h,{style:{"min-width":"350px"}},{default:t(()=>[e(p,null,{default:t(()=>[te]),_:1}),e(p,{class:"q-pt-none"},{default:t(()=>[e(A,{filled:"",modelValue:a(r).val,"onUpdate:modelValue":l[2]||(l[2]=n=>a(r).val=n),"option-label":"name",label:"Sucursal Destino",options:a(r).opts},null,8,["modelValue","options"])]),_:1}),e(I,{align:"right"},{default:t(()=>[T(e(k,{flat:"",icon:"close",color:"negative"},null,512),[[S]]),e(k,{flat:"",icon:"arrow_forward",color:"positive",title:"Traspasar",disable:a(r).val==null,onClick:F},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{ve as default};
