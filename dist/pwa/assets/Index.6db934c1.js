import{Q as L}from"./QInput.9caf5844.js";import{Q as R}from"./QTable.5c2ec61a.js";import{a as c,Q as E}from"./QCard.95011391.js";import{r as u,d as g,k as A,m as _,n as a,p as l,N as e,s as p,av as v,q as m,ax as T,Q as C,R as h,aB as B}from"./index.2999af34.js";import{Q as F,C as q}from"./ClosePopup.1b535112.js";import{u as P,Q as I}from"./use-quasar.c8b4d6a3.js";import{Q as U}from"./QSpinnerDots.2fdc1666.js";import{Q as z}from"./QTooltip.26bb33dd.js";import{Q as j}from"./QPage.1ec59218.js";import{api as N}from"./axios.f75f9d3b.js";const M={class:"full-width row justify-between item-center"},G=p("div",{class:"text-h5"},"salidas s/ entrada",-1),H={class:"text-h6"},J={class:"text-subtitle2"},se={__name:"Index",setup(K){const w=P();let o=u({state:!1,row:null,pts:!1}),d=u([]),r=u(!1),f=u({cols:[{name:"Salida",label:"Salida",field:"SALIDA"},{name:"Sucursal",label:"Sucursal",field:"CLIENTE"},{name:"Referencia",label:"Referencia",field:"REFERENCIA"}],filter:""}),S=u({cols:[{name:"Salida",label:"Salida",field:"SALIDA"},{name:"Sucursal",label:"Sucursal",field:"CLIENTE"},{name:"Referencia",label:"Referencia",field:"REFERENCIA"},{name:"Entrada",label:"Entrada",field:"ENTRADA"}],filter:""}),b=g(()=>d.value.filter(s=>s.ENTRADA!="")),D=g(()=>d.value.filter(s=>s.ENTRADA==""));const x=async()=>{console.log("Cargando Salidas creadas");const s=await N.get("/salidas");console.log(s),d.value=s.data},y=(s,t)=>{console.log(t.SALIDA),o.value.row=t,o.value.state=!0},V=async()=>{console.log("se creara la entrada");let s=o.value.row.SALIDA;r.value=!0;let t=await N.post("/Products/invoiceReceived",{factura:s}).then(n=>n).catch(n=>n);if(t.request.status!=200)console.log(t.request.data),w.notify({message:"No se pudo generar la entrada",icon:"close",color:"negative"});else{let n=t.data.Movimientos.FacturaEntrada,Q=d.value.findIndex(k=>k.SALIDA==s);console.log(Q),d.value[Q].ENTRADA=n,o.value.state=!1,w.notify({message:"Entrada "+n+" realizada",icon:"check_circle",color:"positive"}),r.value=!1}console.log(t)};return x(),(s,t)=>(A(),_(j,{padding:""},{default:a(()=>[l(E,{class:"my-card"},{default:a(()=>[l(c,{class:"col"},{default:a(()=>[l(R,{title:"Salidas",rows:e(D),"row-key":"name",columns:e(f).cols,filter:e(f).filter,onRowClick:y},{top:a(()=>[p("div",M,[G,l(L,{modelValue:e(f).filter,"onUpdate:modelValue":t[0]||(t[0]=i=>e(f).filter=i),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter"])]),_:1}),l(c,{class:"col"},{default:a(()=>[l(R,{title:"Salidas c/ entradas",rows:e(b),"row-key":"name",columns:e(S).cols,filter:e(S).filter},null,8,["rows","columns","filter"])]),_:1})]),_:1}),l(I,{modelValue:e(o).state,"onUpdate:modelValue":t[1]||(t[1]=i=>e(o).state=i),persistent:""},{default:a(()=>[l(E,{class:"my-card"},{default:a(()=>[l(c,null,{default:a(()=>[p("div",H," SALIDA : "+v(e(o).row.SALIDA),1),p("div",J,v(e(o).row.CLIENTE),1)]),_:1}),l(c,null,{default:a(()=>[m(" REFERENCIA : "+v(e(o).row.REFERENCIA),1)]),_:1}),l(F,{align:"right"},{default:a(()=>[T((A(),_(C,{flat:""},{default:a(()=>[m("Cancelar")]),_:1})),[[q]]),l(C,{flat:"",onClick:V,disable:e(r)},{default:a(()=>[m("Crear Entrada")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(I,{modelValue:e(r),"onUpdate:modelValue":t[2]||(t[2]=i=>B(r)?r.value=i:r=i),persistent:e(r)},{default:a(()=>[e(r)?(A(),_(E,{key:0},{default:a(()=>[l(c,{class:"row items-center"},{default:a(()=>[l(U,{color:"secondary",size:"2em"}),l(z,{offset:[0,8]},{default:a(()=>[m("creando..")]),_:1})]),_:1})]),_:1})):h("",!0)]),_:1},8,["modelValue","persistent"])]),_:1}))}};export{se as default};
