import{aF as z,r as f,k as N,m as R,n as i,p as l,O as I,s as t,aG as U,q as r,av as c,N as w,Q as p,ax as B}from"./index.39fcc2d8.js";import{Q as m}from"./QInput.ec274fcd.js";import{Q as V,a as _}from"./QCard.91bba60f.js";import{u as E,r as n,Q as H}from"./use-quasar.0c6b8177.js";import{Q as T}from"./QTable.55195f0e.js";import{Q as q,C as A}from"./ClosePopup.d8cc372e.js";import{Q as j}from"./QPage.29bb7d6a.js";import{api as v}from"./axios.2aa6f7b1.js";import{d as k}from"./dayjs.min.d7cc11dc.js";const F={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4"},G={class:"row"},O={class:"col"},J=t("br",null,null,-1),K={class:"col"},L=t("br",null,null,-1),M={class:"row"},W={class:"col"},X=t("br",null,null,-1),Y={class:"col"},Z=t("br",null,null,-1),ee={class:"row"},le={class:"col"},te=t("br",null,null,-1),ae={class:"col"},se=t("br",null,null,-1),oe={class:"row"},ie={class:"col"},ne=t("br",null,null,-1),de={class:"col"},re=t("br",null,null,-1),ce={class:"text-center"},ue={class:"text-center"},me={class:"text-center"},pe={class:"text-centert"},_e={class:"text-center"},ve={class:"text-center"},Qe={__name:"Devices",setup(ge){const d=E();z();const y=f([]);f(null);const o=f([]),b=f(!1),g=f({columns:[{name:"id",label:"id",field:a=>a.id},{name:"name",label:"Dispositivo",field:a=>a.name},{name:"nick_name",label:"Nombre",field:a=>a.nick_name},{name:"id",label:"Numero de Serie",field:a=>a.serial_number},{name:"ip",label:"Direccion Ip",field:a=>a.ip},{name:"store",label:"Sucursal",field:a=>a.store.name}],filter:"",pagination:{rowsPerPage:[0]}}),h=async()=>{const a=await v.get("/zkt/Index");console.log(a.status),a.status!=200?console.log(a.data):(console.log(a.data),y.value=a.data,x(y.value))},x=a=>{a.forEach((e,s)=>{setTimeout(()=>{v.get(`/zkt/Ping/${e.ip_address}`).then(u=>{console.log(u.data),e._status=u.data.connect,e._att=u.data.register,e._time=u.data.date,e._curret=u.data.current}).catch(u=>{console.error(`Error pinging ${e.ip_address}:`,u)})},s*1e3)})},C=async a=>{d.loading.show({message:"Haciendo Pin :P"});const e=await v.get(`/zkt/Ping/${a}`);if(e.status!=200)console.log(e);else{let s=e.data?"Con Conexion":"Sin Conexion",u=e.data?"positive":"negative";d.notify({message:s,type:u,position:"center"}),d.loading.hide()}},Q=async a=>{console.log(a),d.loading.show({message:"Editando"});const e=await v.post("/zkt/Edit",a);e.status!=200?console.log(e.data):(console.log(e.data),b.value=!1,d.notify({message:"Dispositivo Actualizado",type:"positive",position:"center"}),d.loading.hide(),h())},D=a=>{b.value=!0,o.value=a},P=async()=>{const a=o.value.id;console.log(a),d.loading.show({message:"Impotando Registros :P"});const e=await v.get(`/zkt/getRegisDevice/${a}`);e.status!=200?console.log(e):(console.log(e.data),d.notify({message:e.data.goals,type:"positive",position:"center"}),d.loading.hide())},S=async()=>{const a=o.value.ip_address;console.log(a),d.loading.show({message:"Cambiando Horario :P"});const e=await v.get(`/zkt/changeDate/${a}`);e.status!=200?console.log(e):(console.log(e.data),o.value._time=e.data.date,o.value._curret=e.data.date,d.notify({message:"Cambio Realizado :)",type:"positive",position:"center"}),d.loading.hide())},$=()=>{};return h(),(a,e)=>(N(),R(j,{padding:""},{default:i(()=>[l(T,{"hide-bottom":"",rows:y.value,columns:g.value.columns,"row-key":"name",grid:"",filter:g.value.filter,pagination:g.value.pagination},{"top-right":i(()=>[l(m,{borderless:"",dense:"",debounce:"300",modelValue:g.value.filter,"onUpdate:modelValue":e[0]||(e[0]=s=>g.value.filter=s),placeholder:"Buscar"},{append:i(()=>[l(I,{name:"search"})]),_:1},8,["modelValue"])]),item:i(s=>[t("div",F,[l(V,{flat:"",bordered:"",style:U(`border: 3px solid ${s.row._status?"#03C988":"#B80000"};`),onClick:u=>D(s.row)},{default:i(()=>[l(_,{class:"text-center"},{default:i(()=>[t("div",G,[t("div",O,[r(" Sucursal "),J,t("strong",null,c(s.row.store.name),1)]),t("div",K,[r(" Dispositivo "),L,t("strong",null,c(s.row.name),1)])])]),_:2},1024),l(n),l(_,{class:"text-center"},{default:i(()=>[t("div",M,[t("div",W,[r(" Direccion Ip "),X,t("strong",null,c(s.row.ip_address),1)]),t("div",Y,[r(" Numero de Serie "),Z,t("strong",null,c(s.row.serial_number),1)])])]),_:2},1024),l(n),l(_,{class:"text-center"},{default:i(()=>[t("div",ee,[t("div",le,[r(" Horario "),te,t("strong",null,c(s.row._curret),1)]),t("div",ae,[r(" Dispositivo "),se,t("strong",null,c(s.row._time),1)])])]),_:2},1024),l(n),l(_,{class:"text-center"},{default:i(()=>[t("div",oe,[t("div",ie,[r(" Registros "),ne,t("strong",null,c(s.row._att),1)]),t("div",de,[r(" Diferencia Tiempo "),re,t("strong",null,c(w(k)(s.row._time).diff(w(k)(s.row._curret),"second",!0))+" s",1)])])]),_:2},1024),l(n)]),_:2},1032,["style","onClick"])])]),_:1},8,["rows","columns","filter","pagination"]),l(H,{modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=s=>b.value=s),persistent:""},{default:i(()=>[l(V,null,{default:i(()=>[l(_,{class:"items-center"},{default:i(()=>[l(m,{modelValue:o.value.store.name,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.store.name=s),type:"text",label:"Sucursal",filled:"",disable:""},null,8,["modelValue"]),l(n,{spaced:"",inset:"",vertical:"",dark:""}),l(m,{modelValue:o.value.id,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.id=s),type:"text",label:"Id",filled:"",disable:""},null,8,["modelValue"]),l(n,{spaced:"",inset:"",vertical:"",dark:""}),l(m,{modelValue:o.value.serial_number,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.serial_number=s),type:"text",label:"Numero de serie",filled:"",disable:""},null,8,["modelValue"]),l(n,{spaced:"",inset:"",vertical:"",dark:""}),l(m,{modelValue:o.value.name,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.name=s),type:"text",label:"Dispositivo",filled:"",disable:""},null,8,["modelValue"]),l(n,{spaced:"",inset:"",vertical:"",dark:""}),l(m,{modelValue:o.value.nick_name,"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.nick_name=s),type:"text",label:"Nombre",filled:""},null,8,["modelValue"]),l(n,{spaced:"",inset:"",vertical:"",dark:""}),l(m,{modelValue:o.value.ip_address,"onUpdate:modelValue":e[7]||(e[7]=s=>o.value.ip_address=s),type:"text",label:"IP",filled:""},{append:i(()=>[l(p,{color:"primary",icon:"sensors",onClick:e[6]||(e[6]=s=>C(o.value.ip_address)),flat:""})]),_:1},8,["modelValue"]),l(n,{spaced:"",inset:"",vertical:"",dark:""}),t("div",ce,[r("Dispositivo: "),t("div",ue,c(o.value._time),1)]),l(n,{spaced:"",inset:"",vertical:"",dark:""}),t("div",me,[r(" Horario: "),t("div",pe,c(o.value._curret),1)]),l(n,{spaced:"",inset:"",vertical:"",dark:""}),t("div",_e,[r("Diferencia: "),t("div",ve,c(w(k)(o.value._time).diff(w(k)(o.value._curret),"second",!0)),1)])]),_:1}),l(_,null,{default:i(()=>[l(p,{color:"primary",label:"Registros",onClick:P,outline:"",class:"full-width"}),l(n,{spaced:"",inset:"",vertical:"",dark:""}),l(p,{color:"primary",label:"Cambiar Horario",onClick:S,outline:"",class:"full-width"}),l(n,{spaced:"",inset:"",vertical:"",dark:""}),l(p,{color:"primary",label:"Eliminar Registros",onClick:$,outline:"",class:"full-width"})]),_:1}),l(q,{align:"center"},{default:i(()=>[B(l(p,{flat:"",label:"Cancel",color:"negative"},null,512),[[A]]),l(p,{flat:"",label:"Editar",color:"positive",onClick:e[8]||(e[8]=s=>Q(o.value))})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Qe as default};
