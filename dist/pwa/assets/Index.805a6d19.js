import{u as k,Q as T,c,e as C,d as h,b as E,f as R}from"./use-quasar.6cf1315e.js";import{r as u,d as b,k as A,m as _,n as a,p as l,L as e,s as p,at as v,q as m,av as B,Q as I,O as F,az as q}from"./index.6ea3e414.js";import{Q as z,a as P,C as U}from"./ClosePopup.cfb129da.js";import{Q as j}from"./QSpinnerDots.a4c394f8.js";import{api as N}from"./axios.41f2f890.js";import"./scroll.bd9a67bd.js";const M={class:"full-width row justify-between item-center"},O=p("div",{class:"text-h5"},"salidas s/ entrada",-1),G={class:"text-h6"},H={class:"text-subtitle2"},ee={__name:"Index",setup(J){const w=k();let o=u({state:!1,row:null,pts:!1}),d=u([]),r=u(!1),f=u({cols:[{name:"Salida",label:"Salida",field:"SALIDA"},{name:"Sucursal",label:"Sucursal",field:"CLIENTE"},{name:"Referencia",label:"Referencia",field:"REFERENCIA"}],filter:""}),S=u({cols:[{name:"Salida",label:"Salida",field:"SALIDA"},{name:"Sucursal",label:"Sucursal",field:"CLIENTE"},{name:"Referencia",label:"Referencia",field:"REFERENCIA"},{name:"Entrada",label:"Entrada",field:"ENTRADA"}],filter:""}),D=b(()=>d.value.filter(s=>s.ENTRADA!="")),Q=b(()=>d.value.filter(s=>s.ENTRADA==""));const y=async()=>{console.log("Cargando Salidas creadas");const s=await N.get("/salidas");console.log(s),d.value=s.data},V=(s,t)=>{console.log(t.SALIDA),o.value.row=t,o.value.state=!0},x=async()=>{console.log("se creara la entrada");let s=o.value.row.SALIDA;r.value=!0;let t=await N.post("/Products/invoiceReceived",{factura:s}).then(n=>n).catch(n=>n);if(t.request.status!=200)console.log(t.request.data),w.notify({message:"No se pudo generar la entrada",icon:"close",color:"negative"});else{let n=t.data.Movimientos.FacturaEntrada,g=d.value.findIndex(L=>L.SALIDA==s);console.log(g),d.value[g].ENTRADA=n,o.value.state=!1,w.notify({message:"Entrada "+n+" realizada",icon:"check_circle",color:"positive"}),r.value=!1}console.log(t)};return y(),(s,t)=>(A(),_(T,{padding:""},{default:a(()=>[l(E,{class:"my-card"},{default:a(()=>[l(c,{class:"col"},{default:a(()=>[l(C,{title:"Salidas",rows:e(Q),"row-key":"name",columns:e(f).cols,filter:e(f).filter,onRowClick:V},{top:a(()=>[p("div",M,[O,l(h,{modelValue:e(f).filter,"onUpdate:modelValue":t[0]||(t[0]=i=>e(f).filter=i),type:"text",label:"Buscar"},null,8,["modelValue"])])]),_:1},8,["rows","columns","filter"])]),_:1}),l(c,{class:"col"},{default:a(()=>[l(C,{title:"Salidas c/ entradas",rows:e(D),"row-key":"name",columns:e(S).cols,filter:e(S).filter},null,8,["rows","columns","filter"])]),_:1})]),_:1}),l(R,{modelValue:e(o).state,"onUpdate:modelValue":t[1]||(t[1]=i=>e(o).state=i),persistent:""},{default:a(()=>[l(E,{class:"my-card"},{default:a(()=>[l(c,null,{default:a(()=>[p("div",G," SALIDA : "+v(e(o).row.SALIDA),1),p("div",H,v(e(o).row.CLIENTE),1)]),_:1}),l(c,null,{default:a(()=>[m(" REFERENCIA : "+v(e(o).row.REFERENCIA),1)]),_:1}),l(z,{align:"right"},{default:a(()=>[B((A(),_(I,{flat:""},{default:a(()=>[m("Cancelar")]),_:1})),[[U]]),l(I,{flat:"",onClick:x,disable:e(r)},{default:a(()=>[m("Crear Entrada")]),_:1},8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(R,{modelValue:e(r),"onUpdate:modelValue":t[2]||(t[2]=i=>q(r)?r.value=i:r=i),persistent:e(r)},{default:a(()=>[e(r)?(A(),_(E,{key:0},{default:a(()=>[l(c,{class:"row items-center"},{default:a(()=>[l(j,{color:"secondary",size:"2em"}),l(P,{offset:[0,8]},{default:a(()=>[m("creando..")]),_:1})]),_:1})]),_:1})):F("",!0)]),_:1},8,["modelValue","persistent"])]),_:1}))}};export{ee as default};
