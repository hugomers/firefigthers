import{c as Y,d as h,f as Z,h as ee,r as p,k as C,m as k,n as o,p as l,s as _,q as I,L as t,at as O,O as y,Q as w,N as R,M as L,av as E,az as S}from"./index.73680644.js";import{u as le,Q as te,c as b,g as ae,b as x,d as M,e as Q,f as q}from"./use-quasar.2852789f.js";import{Q as A,a as oe,C as U}from"./ClosePopup.b01f8d2d.js";import{Q as se}from"./QSpinnerDots.708e2d40.js";import{api as N}from"./axios.f2954c6b.js";import"./scroll.5ed3c8c2.js";const ne=["top","middle","bottom"];var ue=Y({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:u=>ne.includes(u)}},setup(u,{slots:m}){const d=h(()=>u.align!==void 0?{verticalAlign:u.align}:null),B=h(()=>{const r=u.outline===!0&&u.color||u.textColor;return`q-badge flex inline items-center no-wrap q-badge--${u.multiLine===!0?"multi":"single"}-line`+(u.outline===!0?" q-badge--outline":u.color!==void 0?` bg-${u.color}`:"")+(r!==void 0?` text-${r}`:"")+(u.floating===!0?" q-badge--floating":"")+(u.rounded===!0?" q-badge--rounded":"")+(u.transparent===!0?" q-badge--transparent":"")});return()=>Z("div",{class:B.value,style:d.value,role:"status","aria-label":u.label},ee(m.default,u.label!==void 0?[u.label]:[]))}});const re={class:"text-h4"},ie={class:"q-pa-md"},de={key:0},ce={class:"q-pa-md"},ve={key:0},fe={class:"text-h6"},me={class:"text-subtitle2"},ge={class:"text-h6"},be={class:"text-subtitle2"},ye={__name:"Index",setup(u){const m=le();let d=p({val:null,opts:[]}),B=p([]),r=p(!1),n=p({state:!1,cols:[],filter:""}),c=p({state:!1,row:null}),V=p(!1),g=p({state:!1,row:null}),P=h(()=>n.value.cols.filter(a=>a.ABONO.includes("-"))),T=h(()=>n.value.cols.filter(a=>a.ABONO==""||a.ABONO=="''")),F=h(()=>n.value.cols.filter(a=>a.ABONO=="No se creara Abono"));const z=async()=>{console.log("Cargando Sucursales");const a=await N.get("/abonos/getSuc").then(e=>e).catch(e=>e);a.request.status!=200?console.log(a.response.data):(console.log(a),B.value=a.data,d.value.opts=a.data)},G=async a=>{console.log(a.id);let e=a.id,s=await N.post("/abonos/getDev",{id:e});n.value.cols=s.data,n.value.state=!0,console.log(s.data)},$=(a,e)=>{c.value.state=!0,c.value.row=e},j=async()=>{r.value=!0,console.log("ignorando");let a=c.value.row.DEVOLUCION,e=d.value.val.id,s="No se creara Abono",f={devol:a,idsuc:e,mssg:s},i=await N.post("/Products/updev",f).then(v=>v).catch(v=>v);if(i.request.status!=200)console.log(i.request),m.notify({message:"status: "+i.request.status+" mssg: "+i.request.statusText,icon:"close",color:"negative"});else{console.log(i.data);let v=n.value.cols.findIndex(D=>D.DEVOLUCION==a);n.value.cols[v].ABONO=s,m.notify({message:"Devolucion "+a+" Ignorada",icon:"check",color:"positive"}),c.value.state=!1,r.value=!1}},H=async()=>{console.log("Generando Abono"),r.value=!0;let a={idsuc:d.value.val.id,devolucion:c.value.row.DEVOLUCION,observacion:c.value.row.REFERENCIA},e=await N.post("/Products/trapasAbo",a).then(f=>f).catch(f=>f);if(e.request.status!=200)console.log(e.request),m.notify({message:"status: "+e.request.status+" mssg: "+e.request.statusText,icon:"close",color:"negative"});else{console.log(e.data);let f=n.value.cols.findIndex(i=>i.DEVOLUCION==e.data.Movimientos.Devolucion);n.value.cols[f].ABONO=e.data.Movimientos.Abono,m.notify({message:"Abono "+e.data.Movimientos.Abono+" creado",icon:"check",color:"positive"}),c.value.state=!1,r.value=!1}};let J=()=>{console.log("Mostrando Ignorados"),V.value=!0},K=async(a,e)=>{console.log(e),g.value.state=!0,g.value.row=e},W=async()=>{console.log("se va a restaurar"),r.value=!0;let a=g.value.row.DEVOLUCION,e=d.value.val.id,s="''",f={devol:a,idsuc:e,mssg:s},i=await N.post("/Products/updev",f).then(v=>v).catch(v=>v);if(i.request.status!=200)console.log(i.request),m.notify({message:"status: "+i.request.status+" mssg: "+i.request.statusText,icon:"close",color:"negative"});else{console.log(i.data);let v=n.value.cols.findIndex(D=>D.DEVOLUCION==a);n.value.cols[v].ABONO=s,m.notify({message:"Devolucion "+a+" restaurada",icon:"check",color:"positive"}),g.value.state=!1,r.value=!1}};return z(),(a,e)=>(C(),k(te,{padding:""},{default:o(()=>[l(x,{class:"my-card row"},{default:o(()=>[l(b,null,{default:o(()=>[_("div",re,[I(" Devoluciones "),t(d).val?(C(),k(ue,{key:0,align:"top"},{default:o(()=>[I(O(t(d).val.name),1)]),_:1})):y("",!0)])]),_:1}),l(b,null,{default:o(()=>[l(ae,{filled:"",modelValue:t(d).val,"onUpdate:modelValue":[e[0]||(e[0]=s=>t(d).val=s),G],"option-label":"name","input-debounce":"0",label:"Sucursal",options:t(d).opts,style:{width:"250px"},behavior:"menu"},null,8,["modelValue","options"])]),_:1}),t(n).state?(C(),k(b,{key:0},{default:o(()=>[l(w,{color:"negative",icon:"archive",onClick:t(J)},null,8,["onClick"])]),_:1})):y("",!0)]),_:1}),_("div",ie,[t(n).state?(C(),R("div",de,[l(Q,{title:"Devoluciones Pendientes",rows:t(T),"row-key":"name",filter:t(n).filter,onRowClick:$},{"top-right":o(()=>[l(M,{borderless:"",dense:"",debounce:"300",modelValue:t(n).filter,"onUpdate:modelValue":e[1]||(e[1]=s=>t(n).filter=s),placeholder:"Buscar"},{append:o(()=>[l(L,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","filter"])])):y("",!0)]),_("div",ce,[t(n).state?(C(),R("div",ve,[l(Q,{title:"Devoluciones con Abono",rows:t(P),"row-key":"name",filter:t(n).filter},{"top-right":o(()=>[l(M,{borderless:"",dense:"",debounce:"300",modelValue:t(n).filter,"onUpdate:modelValue":e[2]||(e[2]=s=>t(n).filter=s),placeholder:"Buscar"},{append:o(()=>[l(L,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","filter"])])):y("",!0)]),l(q,{modelValue:t(V),"onUpdate:modelValue":e[3]||(e[3]=s=>S(V)?V.value=s:V=s),persistent:""},{default:o(()=>[l(x,null,{default:o(()=>[l(b,null,{default:o(()=>[l(A,{vertical:"",align:"left"},{default:o(()=>[E(l(w,{flat:"",icon:"arrow_back"},null,512),[[U]])]),_:1})]),_:1}),l(Q,{rows:t(F),"row-key":"name",onRowClick:t(K)},null,8,["rows","onRowClick"])]),_:1})]),_:1},8,["modelValue"]),l(q,{modelValue:t(g).state,"onUpdate:modelValue":e[4]||(e[4]=s=>t(g).state=s),persistent:""},{default:o(()=>[l(x,{class:"my-card"},{default:o(()=>[l(b,null,{default:o(()=>[_("div",fe," DEVOLUCION : "+O(t(g).row.DEVOLUCION),1),_("div",me," REF : "+O(t(g).row.REFERENCIA),1)]),_:1}),l(A,{align:"right"},{default:o(()=>[E(l(w,{flat:"",label:"Cerrar",color:"primary"},null,512),[[U]]),l(w,{flat:"",label:"Restaurar",color:"primary",onClick:t(W)},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(q,{modelValue:t(c).state,"onUpdate:modelValue":e[5]||(e[5]=s=>t(c).state=s),persistent:""},{default:o(()=>[l(x,{class:"my-card"},{default:o(()=>[l(b,null,{default:o(()=>[_("div",ge,"Devolucion: ("+O(t(c).row.DEVOLUCION)+")",1),_("div",be,"Referencia: "+O(t(c).row.REFERENCIA),1)]),_:1}),l(b,null,{default:o(()=>[l(A,null,{default:o(()=>[l(w,{flat:"",label:"Ignorar",onClick:j}),l(w,{flat:"",label:"Generar Abono",onClick:H,disable:t(r)},null,8,["disable"])]),_:1})]),_:1}),l(A,null,{default:o(()=>[E(l(w,{flat:"",label:"Cerrar"},null,512),[[U]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(q,{modelValue:t(r),"onUpdate:modelValue":e[6]||(e[6]=s=>S(r)?r.value=s:r=s),persistent:t(r)},{default:o(()=>[t(r)?(C(),k(x,{key:0},{default:o(()=>[l(b,{class:"row items-center"},{default:o(()=>[l(se,{color:"secondary",size:"2em"}),l(oe,{offset:[0,8]},{default:o(()=>[I("creando..")]),_:1})]),_:1})]),_:1})):y("",!0)]),_:1},8,["modelValue","persistent"])]),_:1}))}};export{ye as default};
