import{Q as V}from"./QBadge.3bd02123.js";import{Q as J}from"./QHeader.069d3d3c.js";import{u as H,n as f,c as M,Q as P,b as w,J as Q,K as N,L as D}from"./use-quasar.d978fe8b.js";import{r as l,k as i,m as k,n as o,p as e,s as c,Q as v,N as x,O as S,aA as j,aB as A,q as L,at as R}from"./index.2599a239.js";import{a as T,b as q}from"./QLayout.e5916076.js";import{api as p}from"./axios.b00cf2c6.js";import"./QTr.d1660dd9.js";import"./ClosePopup.3ebbfe47.js";import"./scroll.447e74c3.js";const F=c("div",{class:"text-center text-h4"}," Reporte de Asistencias",-1),X={class:"flex justify-center"},K={class:"flex justify-center"},$={class:"flex justify-center"},G={class:"flex justify-center"},W={class:"flex justify-center"},Y={key:0},Z={key:1},ee=c("div",{class:"text-h6"},"SIN CONEXION",-1),ae=c("div",{class:"text-h6"},"CON CONEXION",-1),fe={__name:"AsistenciasLayout",setup(te){const d=H(),g=l(!1),y=l(!1),m=l(!1),h=l(!1),_=l(!1),a=l(!1),b=l({state:!1,body:null}),u=l({state:!1,body:null});l({state:!1,body:null});const B=()=>{console.log("Descargando Archivo");const s=new Date,t=s.getDate()+"-"+(s.getMonth()+1);g.value=!0,a.value=!0;const r=d.notify({type:"ongoing",message:"Descargando Reporte...",position:"center"});p.get("/assist/report",{responseType:"blob"}).then(n=>{const U=window.URL.createObjectURL(new Blob([n.data])),C=document.createElement("a");C.href=U,C.download="reporte del"+t+".xlsx",C.click(),r({type:"positive",message:"Descarga completa"}),g.value=!1,a.value=!1}).catch(n=>{r({type:"negative",message:n.data}),console.log(n),g.value=!1,a.value=!1})},O=async()=>{console.log("Sincronizando Checadas"),m.value=!0,a.value=!0;const s=d.notify({type:"ongoing",message:"Sincronizando Ult. Checadas...",position:"center"});p.get("/zkt/Reportcomplete").then(t=>{s({type:"positive",message:"Proseso terminado"}),m.value=!1,a.value=!1,b.value.body=t.data,b.value.state=!0}).catch(t=>{s({type:"negative",message:t.data}),m.value=!1,a.value=!1})},E=async()=>{console.log("Sincronizando Justificaciones"),y.value=!0,a.value=!0;const s=d.notify({type:"ongoing",message:"Sincronizando Justificaciones...",position:"center"});p.get("/Monday/justification").then(t=>{s({type:"positive",message:t.data}),y.value=!1,a.value=!1}).catch(t=>{s({type:"negative",message:t.data}),y.value=!1,a.value=!1})},I=async()=>{console.log("Conexion a checadores"),h.value=!0,a.value=!0;const s=d.notify({type:"ongoing",message:"Verificando conexiones...",position:"center"});p.get("/pings").then(t=>{s({type:"positive",message:"Mostrando coexiones"}),h.value=!1,a.value=!1,u.value.body=t.data,u.value.state=!0}).catch(t=>{s({type:"negative",message:t.data}),console.log(t),h.value=!1,a.value=!1})},z=async()=>{console.log("Conexion a checadores"),_.value=!0,a.value=!0;const s=d.notify({type:"ongoing",message:"Dando de alta...",position:"center"});p.post("/syncstaff").then(t=>{s({type:"positive",message:"Usuarios Replicados"}),_.value=!1,a.value=!1,console.log(t)}).catch(t=>{s({type:"negative",message:t.data}),console.log(t),_.value=!1,a.value=!1})};return(s,t)=>(i(),k(T,{view:"hHh Lpr fFf"},{default:o(()=>[e(J,{elevated:""},{default:o(()=>[e(V,{color:"{1:orange}","text-color":"{2:black}",label:"Asistencias"})]),_:1}),e(q,null,{default:o(()=>[F,e(f,{spaced:"",inset:"",vertical:"",dark:""}),c("div",X,[e(v,{loading:g.value,onClick:B,color:"primary",icon:"cloud_download",label:"Descargar reporte de asistencias",style:{width:"350px"},disable:a.value},null,8,["loading","disable"])]),e(f,{spaced:"",inset:"",vertical:"",dark:""}),c("div",K,[e(v,{loading:y.value,onClick:E,color:"primary",icon:"warning",label:"Replicar Justificaciones",style:{width:"350px"},disable:a.value},null,8,["loading","disable"])]),e(f,{spaced:"",inset:"",vertical:"",dark:""}),c("div",$,[e(v,{loading:m.value,onClick:O,color:"primary",icon:"sync",label:"Replicar Ultimas Checadas",style:{width:"350px"},disable:a.value},null,8,["loading","disable"])]),e(f,{spaced:"",inset:"",vertical:"",dark:""}),c("div",G,[e(v,{loading:h.value,onClick:I,color:"primary",icon:"sensors",label:"Conexion a sucursales",style:{width:"350px"},disable:a.value},null,8,["loading","disable"])]),e(f,{spaced:"",inset:"",vertical:"",dark:""}),c("div",W,[e(v,{loading:_.value,onClick:z,color:"primary",icon:"group_add",label:"Alta colaboradores faltantes",style:{width:"350px"},disable:a.value},null,8,["loading","disable"])]),b.value.state?(i(),x("div",Y,[e(M,{title:"REPLICACION DE CHECADAS",rows:b.value.body,"row-key":"name"},null,8,["rows"])])):S("",!0),u.value.state?(i(),x("div",Z,[e(P,{class:"my-card"},{default:o(()=>[e(w,null,{default:o(()=>[ee,e(Q,{bordered:""},{default:o(()=>[(i(!0),x(j,null,A(u.value.body.fail,(r,n)=>(i(),k(N,{key:n},{default:o(()=>[e(D,null,{default:o(()=>[L(R(r),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(w,null,{default:o(()=>[ae,e(Q,{bordered:""},{default:o(()=>[(i(!0),x(j,null,A(u.value.body.goal,(r,n)=>(i(),k(N,{key:n},{default:o(()=>[e(D,null,{default:o(()=>[L(R(r),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])):S("",!0)]),_:1})]),_:1}))}};export{fe as default};
