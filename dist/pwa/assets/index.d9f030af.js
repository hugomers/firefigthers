import{Q as X}from"./QBadge.69d11b29.js";import{a as R,Q as F}from"./QCard.7e9739bf.js";import{u as Z,b as W,r as H,Q as ee,o as j,P as M,R as r,S as n}from"./use-quasar.2f956a97.js";import{c as le,o as te,f as ae,a8 as ne,r as h,k as p,m as I,n as t,p as e,s as N,q as o,N as k,av as v,R as oe,Q as U,ax as q,aH as z,P as L,aD as G,aE as J}from"./index.991b573f.js";import{Q as $}from"./QInput.04f97084.js";import{Q as se,C as ie}from"./ClosePopup.ed7d7924.js";import{Q as ue}from"./QPage.abfca986.js";import{api as A}from"./axios.966b62b8.js";var K=le({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(T,{slots:x,emit:D}){let V=!1,C,y,w=null,m=null,u,E;function g(){C&&C(),C=null,V=!1,w!==null&&(clearTimeout(w),w=null),m!==null&&(clearTimeout(m),m=null),y!==void 0&&y.removeEventListener("transitionend",u),u=null}function O(i,b,Q){b!==void 0&&(i.style.height=`${b}px`),i.style.transition=`height ${T.duration}ms cubic-bezier(.25, .8, .50, 1)`,V=!0,C=Q}function B(i,b){i.style.overflowY=null,i.style.height=null,i.style.transition=null,g(),b!==E&&D(b)}function P(i,b){let Q=0;y=i,V===!0?(g(),Q=i.offsetHeight===i.scrollHeight?0:void 0):(E="hide",i.style.overflowY="hidden"),O(i,Q,b),w=setTimeout(()=>{w=null,i.style.height=`${i.scrollHeight}px`,u=S=>{m=null,(Object(S)!==S||S.target===i)&&B(i,"show")},i.addEventListener("transitionend",u),m=setTimeout(u,T.duration*1.1)},100)}function Y(i,b){let Q;y=i,V===!0?g():(E="show",i.style.overflowY="hidden",Q=i.scrollHeight),O(i,Q,b),w=setTimeout(()=>{w=null,i.style.height=0,u=S=>{m=null,(Object(S)!==S||S.target===i)&&B(i,"hide")},i.addEventListener("transitionend",u),m=setTimeout(u,T.duration*1.1)},100)}return te(()=>{V===!0&&g()}),()=>ae(ne,{css:!1,appear:T.appear,onEnter:P,onLeave:Y},x.default)}});const de={class:"text-h4"},re={class:"text-h6 text-center"},ce={class:"text-h6 text-center"},fe={class:"text-h6 text-center"},pe=N("div",{class:"text-h6"},"Seleccione Destino",-1),Ve={__name:"index",setup(T){const x=Z(),D=h(!0),V=h(!0),C=h(!0);let y=h({val:null,opts:[]}),w=h([]),m=h({state:!1,cols:[],filter:""}),u=h({state:!1,cols:[],filter:""});const E=h({state:!1,cols:[],filter:""});let g=h({val:null,opts:null});const O=h({promp:!1,body:null}),B=async()=>{console.log("Cargando Sucursales");const d=await A.get("/abonos/getSuc").then(a=>a).catch(a=>a);d.request.status!=200?console.log(d.response.data):(console.log(d),w.value=d.data,y.value.opts=d.data,g.value.opts=d.data)},P=async d=>{console.log(d.id);let a=d.id,l=await A.post("/abonos/gettras",{id:a});console.log(l.data);let f=l.data.devoluciones,_=l.data.movimientos.map(c=>c.refund);m.value.cols=f.filter(c=>!_.includes(c.DEVOLUCION)),m.value.state=!0,u.value.cols=l.data.movimientos.filter(c=>c.season_ticket==null||c.invoice==null||c.entry==null),E.value.cols=l.data.movimientos.filter(c=>c.season_ticket!=null&&c.invoice!=null&&c.entry!=null)},Y=d=>{console.log(d),O.value.promp=!0,O.value.body=d},i=async()=>{console.log("iniciar");let d={from:y.value.val,to:g.value.val,devolucion:O.value.body};console.log(d);let a=await A.post("/abonos/iniproces",d);if(console.log(a),a.request.status!=200){console.log("error brou"),console.log(a);let f=a.response.data.error.msg;x.notify({message:f,icon:"close",color:"negative"})}else{O.value.promp=!1,g.value.val=null,x.notify({message:"Se Inicio",icon:"check_circle",color:"positive",position:"center"}),a.data.season_ticket!=null&&a.data.invoice!=null&&a.data.entry!=null?E.value.cols.push(a.data):(a.data.season_ticket==null||a.data.invoice==null||a.data.entry==null)&&u.value.cols.push(a.data);let f=m.value.cols.findIndex(s=>s.DEVOLUCION==a.data.refund);m.value.cols.splice(f,1)}},b=async d=>{let a=d,l=await A.post("/abonos/nabo",a);if(console.log(l),l.request.status!=200){console.log("error brou"),console.log(l);let s=l.response.data.error.msg;x.notify({message:s,icon:"close",color:"negative"})}else{let s=l.data.season_ticket;x.notify({message:`Abono Creado ${s}`,icon:"check_circle",color:"positive",position:"center"});let _=u.value.cols.findIndex(c=>c.id==l.data.id);l.data.season_ticket!=null&&l.data.invoice!=null&&l.data.entry!=null?(E.value.cols.push(l.data),u.value.cols.splice(_,1)):(l.data.season_ticket!=null||l.data.invoice==null||l.data.entry==null)&&(u.value.cols[_].season_ticket=l.data.season_ticket,console.log(u.value.cols[_].season_ticket))}},Q=async d=>{console.log(d);let a=d;console.log(a);let l=await A.post("/abonos/ninv",a);if(console.log(l),l.request.status!=200){console.log("error brou"),console.log(l);let s=l.response.data.error.msg;x.notify({message:s,icon:"close",color:"negative"})}else{let s=l.data.invoice;x.notify({message:`Salida Creada ${s}`,icon:"check_circle",color:"positive",position:"center"});let _=u.value.cols.findIndex(c=>c.id==l.data.id);l.data.season_ticket!=null&&l.data.invoice!=null&&l.data.entry!=null?(E.value.cols.push(l.data),u.value.cols.splice(_,1)):(l.data.invoice!=null||l.data.season_ticket==null||l.data.entry==null)&&(u.value.cols[_].invoice=l.data.invoice,console.log(u.value.cols[_].invoice))}},S=async d=>{console.log(d);let a=d;console.log(a);let l=await A.post("/abonos/nent",a);if(console.log(l),l.request.status!=200){console.log("error brou"),console.log(l);let s=l.response.data.error.msg;x.notify({message:s,icon:"close",color:"negative"})}else{let s=l.data.entry;x.notify({message:`Entrada Creada ${s}`,icon:"check_circle",color:"positive",position:"center"});let _=u.value.cols.findIndex(c=>c.id==l.data.id);l.data.season_ticket!=null&&l.data.invoice!=null&&l.data.entry!=null?(E.value.cols.push(l.data),u.value.cols.splice(_,1)):(l.data.entry!=null||l.data.invoice==null||l.data.season_ticket==null)&&(u.value.cols[_].entry=l.data.entry,console.log(u.value.cols[_].entry))}};return B(),(d,a)=>(p(),I(ue,{padding:""},{default:t(()=>[e(F,{class:"my-card row"},{default:t(()=>[e(R,null,{default:t(()=>[N("div",de,[o(" Traspasos "),k(y).val?(p(),I(X,{key:0,align:"top"},{default:t(()=>[o(v(k(y).val.name),1)]),_:1})):oe("",!0)])]),_:1}),e(R,null,{default:t(()=>[e(W,{filled:"",modelValue:k(y).val,"onUpdate:modelValue":[a[0]||(a[0]=l=>k(y).val=l),P],"option-label":"name","input-debounce":"0",label:"Sucursal",options:k(y).opts,style:{width:"250px"},behavior:"menu"},null,8,["modelValue","options"])]),_:1})]),_:1}),e(H,{spaced:"",inset:"",vertical:"",dark:""}),e(F,{class:"my-card"},{default:t(()=>[e(R,null,{default:t(()=>[N("div",re,[o("Sin Movimiento "),e(U,{color:"grey",round:"",flat:"",dense:"",icon:D.value?"keyboard_arrow_up":"keyboard_arrow_down",onClick:a[1]||(a[1]=l=>D.value=!D.value)},null,8,["icon"])])]),_:1}),e(K,null,{default:t(()=>[q(N("div",null,[(p(!0),L(J,null,G(k(m).cols,(l,f)=>(p(),L("div",{key:f},[e(j,{bordered:""},{default:t(()=>[e(M,null,{default:t(()=>[e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" DEVOLUCION")]),_:1}),e(n,null,{default:t(()=>[o(v(l.DEVOLUCION),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" REFERENCIA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.REFERENCIA),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" PROVEEDOR")]),_:1}),e(n,null,{default:t(()=>[o(v(l.PROVEEDOR),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" FECHA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.FECHA),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,null,{default:t(()=>[e(U,{color:"primary",flat:"",label:"Iniciar",icon:"send",onClick:s=>Y(l)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(H,{spaced:"",inset:"",vertical:"",dark:""})]))),128))],512),[[z,D.value]])]),_:1})]),_:1}),e(F,{class:"my-card"},{default:t(()=>[e(R,null,{default:t(()=>[N("div",ce,[o("Con Movimiento "),e(U,{color:"grey",round:"",flat:"",dense:"",icon:V.value?"keyboard_arrow_up":"keyboard_arrow_down",onClick:a[2]||(a[2]=l=>V.value=!V.value)},null,8,["icon"])])]),_:1}),e(K),q(N("div",null,[(p(!0),L(J,null,G(k(u).cols,(l,f)=>(p(),L("div",{key:f},[e(j,{bordered:""},{default:t(()=>[e(M,null,{default:t(()=>[e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" DEVOLUCION")]),_:1}),e(n,null,{default:t(()=>[o(v(l.refund),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" REFERENCIA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.reference),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" PROVEEDOR")]),_:1}),e(n,null,{default:t(()=>[o(v(l.provider),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" FECHA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.created_at),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" ABONOS ")]),_:1}),l.season_ticket==null?(p(),I(n,{key:0},{default:t(()=>[e(U,{color:"primary",flat:"",label:"Abono",onClick:s=>b(l)},null,8,["onClick"])]),_:2},1024)):(p(),I(n,{key:1},{default:t(()=>[e($,{dense:"",filled:"","item-aligned":!0,modelValue:l.season_ticket,"onUpdate:modelValue":s=>l.season_ticket=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" Salida ")]),_:1}),l.invoice==null?(p(),I(n,{key:0},{default:t(()=>[e(U,{color:"primary",flat:"",label:"Salida",onClick:s=>Q(l)},null,8,["onClick"])]),_:2},1024)):(p(),I(n,{key:1},{default:t(()=>[e($,{dense:"",filled:"","item-aligned":!0,modelValue:l.invoice,"onUpdate:modelValue":s=>l.invoice=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" Entrada ")]),_:1}),l.entry==null?(p(),I(n,{key:0},{default:t(()=>[e(U,{color:"primary",flat:"",label:"Entrada",onClick:s=>S(l)},null,8,["onClick"])]),_:2},1024)):(p(),I(n,{key:1},{default:t(()=>[e($,{dense:"",filled:"","item-aligned":!0,modelValue:l.entry,"onUpdate:modelValue":s=>l.entry=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))]),_:2},1024)]),_:2},1024)]),_:2},1024),e(H,{spaced:"",inset:"",vertical:"",dark:""})]))),128))],512),[[z,V.value]])]),_:1}),e(F,{class:"my-card"},{default:t(()=>[e(R,null,{default:t(()=>[N("div",fe,[o("Terminadas "),e(U,{color:"grey",round:"",flat:"",dense:"",icon:C.value?"keyboard_arrow_up":"keyboard_arrow_down",onClick:a[3]||(a[3]=l=>C.value=!C.value)},null,8,["icon"])])]),_:1}),e(K,null,{default:t(()=>[q(N("div",null,[(p(!0),L(J,null,G(E.value.cols,(l,f)=>(p(),L("div",{key:f},[e(j,{bordered:""},{default:t(()=>[e(M,null,{default:t(()=>[e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" DEVOLUCION")]),_:1}),e(n,null,{default:t(()=>[o(v(l.refund),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" REFERENCIA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.reference),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" PROVEEDOR")]),_:1}),e(n,null,{default:t(()=>[o(v(l.provider),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" FECHA")]),_:1}),e(n,null,{default:t(()=>[o(v(l.created_at),1)]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" ABONOS ")]),_:1}),e(n,null,{default:t(()=>[e($,{dense:"",filled:"","item-aligned":!0,modelValue:l.season_ticket,"onUpdate:modelValue":s=>l.season_ticket=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" Salida ")]),_:1}),e(n,null,{default:t(()=>[e($,{dense:"",filled:"","item-aligned":!0,modelValue:l.invoice,"onUpdate:modelValue":s=>l.invoice=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(r,{class:"text-center"},{default:t(()=>[e(n,{caption:""},{default:t(()=>[o(" Entrada ")]),_:1}),e(n,null,{default:t(()=>[e($,{dense:"",filled:"","item-aligned":!0,modelValue:l.entry,"onUpdate:modelValue":s=>l.entry=s,type:"text",disable:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(H,{spaced:"",inset:"",vertical:"",dark:""})]))),128))],512),[[z,C.value]])]),_:1})]),_:1}),e(ee,{modelValue:O.value.promp,"onUpdate:modelValue":a[5]||(a[5]=l=>O.value.promp=l),persistent:""},{default:t(()=>[e(F,{style:{"min-width":"350px"}},{default:t(()=>[e(R,null,{default:t(()=>[pe]),_:1}),e(R,{class:"q-pt-none"},{default:t(()=>[e(W,{filled:"",modelValue:k(g).val,"onUpdate:modelValue":a[4]||(a[4]=l=>k(g).val=l),"option-label":"name",label:"Sucursal Destino",options:k(g).opts},null,8,["modelValue","options"])]),_:1}),e(se,{align:"right"},{default:t(()=>[q(e(U,{flat:"",icon:"close",color:"negative"},null,512),[[ie]]),e(U,{flat:"",icon:"arrow_forward",color:"positive",title:"Traspasar",disable:k(g).val==null,onClick:i},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ve as default};
